#!/bin/bash
set -euo pipefail
cd "$(dirname "$0")"

if ! compgen -G "features/*.feature" > /dev/null 2>&1; then
    echo "âŒ No .feature files. Chat with manager first: claude"
    exit 1
fi

mkdir -p qa/reports

cat > status.json <<EOF
{
  "phase": "generating-tests",
  "cycle": 0,
  "max_cycles": 5,
  "last_updated": "$(date -Iseconds)",
  "summary": "QA generating tests from .feature specs"
}
EOF

echo "ğŸ§ª Opening QA engineer session..."
echo "   They'll read features/*.feature and generate tests."
echo "   You can watch and help."
echo ""

claude --system-prompt "$(cat qa/CLAUDE.md)" \
  --resume "Read ALL features/*.feature files and generate automated tests for every scenario. Create qa/run-tests.sh to run them. Tests will fail now â€” that's expected, no implementation yet."
